status,issue,title,validator comment 1,validator comment 2,validator comment 3,root cause 1,root cause 2,root cause 3,merged root cause,primary finding,proposed root cause group,,,,,
Satisfactory,findings-14,`earlyExit` is not set to true in `transferAllowanceEvent` case in `smartcontract_log_parser:GetTxInItem`,"early Exit, dust spam to DoS Bifrost",,"Missing earlyExit in transferAllowanceEvent case may allow multiple events, causing transaction inconsistencies.","https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L189,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L295",,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L244,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L244,findings-14,"DUPE-smartcontract_log_parser-001,DUPE-smartcontract_log_parser-001,DUPE-smartcontract_log_parser-001",DUPE-smartcontract_log_parser-001,,,,
Satisfactory,findings-12,`batchTransferOutAndCallV5` Fails Due to Out of Funds,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L307-L328,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L307-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,findings-3,The batchTransferOutAndCallV5 function can never handle batch operations with ETH,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-005",,,,,
Satisfactory,findings-7,Use of msg.value in _transferOutAndCallV5 loop breaks batchTransferOutAndCallV5 batch functionality.,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L399,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L399,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-006",,,,,
Satisfactory,validation-112,`THORChain_Router::batchTransferOutAndCallV5` can be abused and user can drain contract funds.,batch msg.value,,Batch call can revert due to msg.value in a loop. Draining is only possible if the contract has ETH balance,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L307-L341,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L307-L341,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,validation-122,Msg-value-loop,batch msg.value,,Batch call can revert due to msg.value in a loop. Draining is only possible if the contract has ETH balance,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L389,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-137,batchTransferOutAndCallV5 cannot work correctly with ETH transfers,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397-L403,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397-L403",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-006",DUPE-THORChain_Router-006,,,,
Satisfactory,validation-138,batch transfers will fail cause msg.value is used instead of aggregationPayload.fromAmount,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-146,Using msg.value inside a loop breaks function functionality,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-005",,,,,
Satisfactory,validation-150,"[M-03] Indirect use of `msg.value` in for loop, causing DoS of `THORChain_Router::batchTransferOutAndCallV5`",batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L310,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-157,Batch transfers will not work.,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L326","https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L326,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-002",DUPE-THORChain_Router-002,,,,
Satisfactory,validation-169,BatchTransferOutAndCallV5 iterate msg value,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L185-L207,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L185-L207,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-008",,,,,
Satisfactory,validation-170,Any Eth in router contract can be stolen by a malicious user,batch msg.value,router contract not intended to hold ETH,Exploitable ETH transfer vulnerability in transfer functions,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L246-L250,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L246-L250,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-009",,,,,
Satisfactory,validation-177,Incorrect Ether Distribution in `batchTransferOutAndCallV5` Function,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L326",findings-7,findings-7,"DUPE-THORChain_Router-002,DUPE-THORChain_Router-005,DUPE-THORChain_Router-006",DUPE-THORChain_Router-002,DUPE-THORChain_Router-005,DUPE-THORChain_Router-006,,
Satisfactory,validation-185,"Due to the use of `msg.value` in for loop, anyone can drain all the funds from the `THORChain_Router` contract",batch msg.value,,Batch call can revert due to msg.value in a loop. Draining is only possible if the contract has ETH balance,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L400-L402,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L400-L402,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-010",,,,,
Satisfactory,validation-215,"`batchTransferOutAndCallV5` might revert if there are more than 2 calls, which transfer ETH",batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L311,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-228,"`batchTransferOutAndCallV5` function is broken, it will not work in some cases and in some cases it will emit wrong event values.",batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L310,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-23,Using `msg.value` in a loop allows the contract to be completely drained,batch msg.value,,Batch call can revert due to msg.value in a loop. Draining is only possible if the contract has ETH balance,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L326","https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L326,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-002",DUPE-THORChain_Router-002,,,,
Satisfactory,validation-239,`batchTransferOutAndCallV5` will be unusable due to msg.value in a loop type situation.,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L401,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L401,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-011",,,,,
Satisfactory,validation-5,`batchTransferOutV5` fails when there are more than one native asset transfers,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397-L403,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397-L403,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-006",,,,,
Satisfactory,validation-74,Passing multiple msg.value in the _transferOutAndCallV5 function can cause batchTransferOutAndCallV5 to fail,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,findings-7,findings-7,DUPE-THORChain_Router-002,,,,,
Satisfactory,validation-76,`THORChain_Router::batchTransferOutAndCallV5` function uses `msg.value` in a loop which makes the function unusable for batch transfers of ETH,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-85,THORChain_Router::batchTransferOutAndCallV5 reuses msg.value across a batch and will revert.,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397-L403,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397-L403,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-005",,,,,
Satisfactory,validation-90,`batchTransferOutAndCallV5` Will Always Revert if There is More Than One `ETH` Transfer,batch msg.value,,Batch call can revert due to msg.value in a loop,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L310,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L326","https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L326,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",findings-7,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-002",DUPE-THORChain_Router-002,,,,
Satisfactory,validation-108,Gas Price Overestimation Due to Incorrect Standard Deviation Calculation.,"line 292, it takes the mean","The report is valid, but not sure it's a M issue",Standard deviation calculation needs (n-1) adjustment,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L281-L289,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L281-L289,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L281-L289,validation-108,DUPE-ethereum_block_scanner-001,,,,,
Satisfactory,validation-101,Missing Event Handling for `TransferOutAndCallV5` in `smartcontract_log_parser`,"miss transferoutandcallv5 event, overwrite tx",,"Missing critical event handling, causing inconsistencies",https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,validation-121,validation-121,,,,,,
Satisfactory,validation-121,The `TransferOutAndCallV5` event is not caught by `smartcontract_log_parser.go`,"miss transferoutandcallv5 event, overwrite tx",,Missed event leads to inconsistencies and fund loss,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L22-L26,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343,validation-121,,,,,,
Satisfactory,validation-224,Events arent being logged and parsed properly according to the docs.,"miss transferoutandcallv5 event, overwrite tx",,Low QA frequently reported by bots and analyzers.,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209,validation-121,validation-121,,,,,,
Satisfactory,validation-8,"`transferOutAndCallV5` and `batchTransferOutAndCallV5` emit the `TransferOutAndCallV5` event, which is not handled in Bifrost","miss transferoutandcallv5 event, overwrite tx",,Inadequate proof and elaboration,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343,validation-121,validation-121,,,,,,
Satisfactory,findings-11,`_transferOutAndCallV5` Does Not Send Gas Token to Recipient on Failing Aggregator,aggregation target,,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,findings-13,`_transferOutAndCallV5` Doesn't Return Funds to Recipient with Failing Aggregator,aggregation target,,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L346-L376,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L346-L376,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,findings-2,ETH is transferred to the wrong address in _transferOutAndCallV5,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-102,Wrong address will receive msg.value when call failed,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-110,The function `THORChain_Router::_transferOutAndCallV5` is sending the ether to the `target` instead of the `recipient`.,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-002",DUPE-THORChain_Router-002,,,,
Satisfactory,validation-141,"In _transferOutAndCallV5, ETH is incorrectly sent to target",aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-155,"[H-02] Incorrect recipient inside `THORChain_Router::_transferOutAndCallV5`, leading to sending gas asset to the payload target, not the recipient",aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324",validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,validation-179,ETH is sent to the aggregator contract instead of Recipient Address.,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L328,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,validation-197,Calling `_transferOutAndCallV5` function with `aggregationPayload.fromAsset` being `address(0)` causes vault to incorrectly send `msg.value` to target aggregator instead of recipient when calling target aggregator's `swapOutV5` function reverts,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-227,ETH is sent to the wrong address,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-234,Native token is sent to the wrong address in `_transferOutAndCallV5()` leading to the theft of these assets,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-26,"Send eth to the wrong person, which leads to errors.",aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,validation-3,"`_transferOutAndCallV5` transfers gas assets to a wrong address when the swap fails, resulting in the loss of user funds",aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,validation-35,If calling `swapOutV5` would fail on target contract this could lead to loss of funds,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,validation-39,If swap fails a vault will lose the ETH it has sent,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-49,Logic error in _transferOutAndCallV5 internal function,aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L324,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-004",,,,,
Satisfactory,validation-60,User can loss hsi funds in `_transferOutAndCallV5` function,aggregation target,,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L364,validation-155,validation-155,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-001",,,,,
Satisfactory,validation-80,"If the swapOut fails, the Ether should be sent to the recipient instead of the aggregator",aggregation target,,Incorrect recipient address for failed swaps,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,validation-155,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-187,looping through the whiteList aggregator even though disableWhitelist=1,isToValidContractAddress() parameter,,Causing unintended whitelist bypass,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L911,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L902-L928,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L902-L928,validation-187,DUPE-ethereum_block_scanner-001,,,,,
Satisfactory,findings-4,"When the ETH interaction fails, the event will also be triggered normally","failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L195,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024",DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,
Satisfactory,validation-10,"`TransferOutAndCall` event is still emitted for failed `transferOutAndCall`, which will be observed by Bifrost","failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280-L292,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L261-L293,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L209-L238","https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-002,DUPE-THORChain_Router-016,DUPE-THORChain_Router-018",DUPE-THORChain_Router-018,,,,
Satisfactory,validation-144,_transferOutAndCallV5 emits event even if aggregator fails,"failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L389,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,DUPE-THORChain_Router-002,,,,,
Satisfactory,validation-156,"[H-03] Incorrect event emissions, tricking the `smartcontract_log_parser`","failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L330,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-002,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024",DUPE-THORChain_Router-002,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,
Satisfactory,validation-191,ThorChain will be informed wrongly about the unsuccessful ETH transfers due to the incorrect events emissions,"failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-008,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024",DUPE-THORChain_Router-008,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,
Satisfactory,validation-206,THORChain_Router:TransferOut event will be emitted even it the ETH transfer wasn't successful,"failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-002,DUPE-THORChain_Router-018,DUPE-THORChain_Router-021",DUPE-THORChain_Router-021,,,,
Satisfactory,validation-235,"When dealing with native coin, the `TransferOut*` events are still triggered on error","failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-017,DUPE-THORChain_Router-023,DUPE-THORChain_Router-024",DUPE-THORChain_Router-017,DUPE-THORChain_Router-023,DUPE-THORChain_Router-024,,
Satisfactory,validation-241,Incorrect Event Emission due to Ether Transfer Failure in THORChain Router Contract,"failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L207,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-017,DUPE-THORChain_Router-021,DUPE-THORChain_Router-024",DUPE-THORChain_Router-017,DUPE-THORChain_Router-021,DUPE-THORChain_Router-024,,
Satisfactory,validation-58,`THORChain_Router::transferOut`  and `THORChain_Router::_transferOutV5` emits incorrect data in `TransferOut` event breaking one of the Main Invariants of the Protocol,"failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L182-L238,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024",DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,,
Satisfactory,validation-82,"If swap fails incorrect event data is emitted in `THORChain_Router::transferOutAndCall` function, leading to incorrect tracking of funds by the Bifrost and breaking Main Invariant of the protocol","failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L261-L293,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024",DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,,
Satisfactory,validation-91,Refund functionality breaks protocol logic,"failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024",DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,,
Satisfactory,validation-98,Incorrect Information Displayed by Events in THORChain_Router.sol,"failed swap, wrong event",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L206,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196-L206,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L277-L292,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213-L236,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L323-L387",validation-191,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024",DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,
Satisfactory,validation-81,TransferOutAndCall event should not be emitted if the `ethSuccess` is false,"wrong event
 failed swap should revert",,Misleading non-discrete events can cause fund misallocation issues,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326","https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",validation-191,validation-191,"DUPE-THORChain_Router-004,DUPE-THORChain_Router-009,DUPE-THORChain_Router-010,DUPE-THORChain_Router-011,DUPE-THORChain_Router-012",DUPE-THORChain_Router-004,DUPE-THORChain_Router-009,DUPE-THORChain_Router-010,DUPE-THORChain_Router-011,DUPE-THORChain_Router-012
Satisfactory,validation-198,`aggregationPayload.fromAmount` of an ERC20 token can be lost when calling `_transferOutAndCallV5` function for such token if target aggregator's `swapOutV5` function call reverts,failed swap should revert,,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L304-L389,validation-198,validation-198,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-226,Assets can be stolen after a swap attempt in `_transferOutAndCallV5()`,failed swap should revert,,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L338-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L338-L375,validation-198,validation-198,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-36,Unsuccessful swap could lead to loss of ERC20 tokens,failed swap should revert,,Inadequate elaboration,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L341-L388,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L364,validation-198,validation-198,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-77,"Without checking _dexAggSuccess, there is a risk of losing transferred assets to the `aggregationPayload.target`","failed swap should revert
 low quality report",,Inadequate elaboration,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L364,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L364,validation-198,validation-198,"DUPE-THORChain_Router-003,DUPE-THORChain_Router-004",DUPE-THORChain_Router-003,DUPE-THORChain_Router-004,,,
Satisfactory,validation-9,"`_transferOutAndCallV5` does not revert when the swap in aggregator fails, leading to loss of recipient's funds",failed swap should revert,,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,validation-198,validation-198,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002",,,,,
Satisfactory,validation-119,Router transferOutAndCallV5:  Fee on transfer tokens lead to an error when swap and incorrect approval accounting,fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L367,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L375,validation-199,validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-001",,,,,
Satisfactory,validation-133,Protocol could be tricked on some to-be integrated tokens,fee on transfer,,Identifies and suggests banning FOT like or rebasing tokens,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375","https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L66-L73,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160","https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-003,DUPE-smartcontract_log_parser-003",DUPE-smartcontract_log_parser-003,,,,
Satisfactory,validation-143,"If the fromAsset in the _transferOutAndCallV5 function is a fee-on token, the exchange may fail.",fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L360,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L360,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-149,"[M-02] Incorrect call argument in `THORChain_Router::_transferOutAndCallV5`, leading to grief/steal of `THORChain_Aggregator`'s funds or DoS",fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375",https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L368,validation-199,validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-003",DUPE-THORChain_Router-003,,,,
Satisfactory,validation-152,Rebasing tokens are not handled correctly,fee on transfer,,Identifies and suggests supposed fix for FOT like or rebasing tokens,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L54,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L54,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-012",,,,,
Satisfactory,validation-182,SwapOutV5 : Fees are not deducted from the fromAmount  on `Fee On Transfer ERC20 Token's`  Transaction.,fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375",https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L347-L389,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-003",DUPE-THORChain_Router-003,,,,
Satisfactory,validation-184,The router contract is not compatible with fee-on-transfer tokens,fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,validation-199,validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-003",,,,,
Satisfactory,validation-196,"Attacker can steal shares of ""vault-like"" tokens, such as stETH, that should belong to legitimate vaults",fee on transfer,,Identifies and suggests supposed fix for FOT like or rebasing tokens,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131-L140,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-003,DUPE-THORChain_Router-019",DUPE-THORChain_Router-019,,,,
Satisfactory,validation-199,"Calling `_transferOutAndCallV5` function is always DOS'ed for all vaults when corresponding ERC20 token is a fee-on-transfer token, such as STA",fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L304-L389,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-003",,,,,
Satisfactory,validation-214,`_transferOutAndCallV5`  function is incompatible for the Fee-on-Transfer tokens,fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375",https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L368,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-003",DUPE-THORChain_Router-003,,,,
Satisfactory,validation-218,The new `_transferOutAndCallV5()` function is not compatible with fee-on-transfer and rebase tokens,fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,validation-199,validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-003",,,,,
Satisfactory,validation-236,`_transferOutAndCallV5()` is incompatible with fee on transfer tokens,fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-246,"Some of token's underlying assets for corresponding vault can fail to be transferred when such token is a rebasing token or token with airdrops, such as AMPL",fee on transfer,,Identifies and suggests banning FOT like or rebasing tokens,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L326",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-001,DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,DUPE-THORChain_Router-025",DUPE-THORChain_Router-013,DUPE-THORChain_Router-013,DUPE-THORChain_Router-024,DUPE-THORChain_Router-025,
Satisfactory,validation-4,The THORChain Router is not compatible with ERC20 tokens that modify balances outside of transfers,,,Identifies and suggests banning FOT like or rebasing tokens,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,validation-199,validation-199,DUPE-THORChain_Router-003,,,,,
Satisfactory,validation-40,A malicious user can steal money out of the vault and other users,fee on transfer,,Identifies and suggests banning FOT like or rebasing tokens,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375",https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-003,DUPE-THORChain_Router-015",DUPE-THORChain_Router-015,,,,
Satisfactory,validation-44,Fee on transfer tokens will make `_transferOutAndCallV5()` revert,fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L367,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L304-L389,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-001",,,,,
Satisfactory,validation-48,Calling transferOutAndCallV5 function with fee on transfer token will fail,fee on transfer,,Identifies and mitigates fee-on-transfer token issue,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L142-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375","https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L391,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L364",validation-199,validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-002,DUPE-THORChain_Router-003,DUPE-THORChain_Router-022",DUPE-THORChain_Router-003,DUPE-THORChain_Router-022,,,
Satisfactory,validation-52,User could get his funds locked using a particular type of tokens,fee on transfer,,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L355,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L367,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L26,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156-L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483",validation-199,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-001,DUPE-THORChain_Router-020",DUPE-THORChain_Router-020,,,,
Satisfactory,validation-33,Users will be denied from using a particular protocol functionality under a certain case,"direct swap path, seems out of scope",,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L304-L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L304-L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L304-L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L304-L389,validation-33,DUPE-THORChain_Router-001,,,,,
Satisfactory,validation-45,Bifrost `risk of DoS` due to the increase in transactions and events to process,bifrost tx load analysis,,DoS risk due to increased transaction processing. QA prone but should be reviewed for visibility given the elaborate report.,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,validation-45,DUPE-smartcontract_log_parser-001,,,,,
Satisfactory,validation-6,`Fund stuck forever` in vault in case of multiple deposits to different vaults,multiple deposits to different vault,,Funds loss possible due to system's inability to handle multiple deposits in a single transaction.,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L182-L212,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L182-L212,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L182-L212,validation-6,validation-6,DUPE-smartcontract_log_parser-001,,,,,
Satisfactory,validation-69,smartcontract_log_parser.go client is setting `isVaultTransfer` to true  in the vaultTransferEvent case,seems limited impacted,,isVaultTransfer not set for vaultTransferEvent case,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L342,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L342,validation-69,validation-69,DUPE-smartcontract_log_parser-001,,,,,
Satisfactory,findings-8,"When calling the batchTransferOutV5 functions, some events may be filtered out",multiple deposits to different vault,,Filtering out valid batch transaction events,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L182-L212,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L213,"https://github.com/code-423n4/2024-06-thorchain/blob/e5ae503d0dc2394a82242be6860eb538345152a1/ethereum/contracts/THORChain_Router.sol#L247-L253, https://github.com/code-423n4/2024-06-thorchain/blob/e5ae503d0dc2394a82242be6860eb538345152a1/ethereum/contracts/THORChain_Router.sol#L209-L238, https://github.com/code-423n4/2024-06-thorchain/blob/e5ae503d0dc2394a82242be6860eb538345152a1/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343",validation-7,"DUPE-smartcontract_log_parser-001,DUPE-smartcontract_log_parser-001",,,,,
Satisfactory,validation-7,"`batchTransferOutV5` could emit multiple `TransferOut` events, but Bifrost Observation can handle only one per transaction.","miss transferoutandcallv5 event, overwrite tx",,Insufficient proof on filtering due to the inexpedience of having multiple transferOut events,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343,"https://github.com/code-423n4/2024-06-thorchain/blob/e5ae503d0dc2394a82242be6860eb538345152a1/ethereum/contracts/THORChain_Router.sol#L247-L253, 
 https://github.com/code-423n4/2024-06-thorchain/blob/e5ae503d0dc2394a82242be6860eb538345152a1/ethereum/contracts/THORChain_Router.sol#L209-L238, 
 https://github.com/code-423n4/2024-06-thorchain/blob/e5ae503d0dc2394a82242be6860eb538345152a1/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166-L343",validation-7,DUPE-smartcontract_log_parser-001,,,,,
Satisfactory,validation-83,Bifrost `risk of griefing attack` due to missing early exit path for `transferOutAndCall`,"early Exit, dust spam to DoS Bifrost",,DoS risk via griefing attack in transferOutAndCall. QA prone but should be reviewed for visibility given the elaborate report.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L189,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L295",https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L295,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L295,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L295,validation-83,"DUPE-smartcontract_log_parser-001,DUPE-smartcontract_log_parser-001",,,,,
Unsatisfactory,validation-50,safeApprove internal function fail to check return value of tokens approve function,"USDT safeApprove
 similar to approve(0)",,Low QA frequently reported by bots and analyzer,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L485,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L485,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L485,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494",,"DUPE-THORChain_Router-014,DUPE-THORChain_Router-015",,,,,
Unsatisfactory,findings-10,Excess Ether Not Returned in `transferOutV5` and `batchTransferOutV5` Functions,"excess eth, transferOutPayload.amount and msg.value",,Low QA on user input mistake,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L391,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L391",,,,,,,
Unsatisfactory,findings-5,"Due to incomplete check, in some cases, Router contracts may hold some ETH","excess eth, transferOutPayload.amount and msg.value",,Low QA on user input mistake,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L240,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L240",,,,,,,
Unsatisfactory,validation-100,"`_transferOutV5` Not Returning Extra ETH, Leading to Locked Funds","excess eth, transferOutPayload.amount and msg.value",,Low QA on user input error,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209-L215,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209-L215",,,,,,,
Unsatisfactory,validation-113,Missing msg.value and input argument validation,batch msg.value,,Exploitable ETH transfer vulnerability in transfer functions,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L391,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L391,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L309-L321",,"DUPE-THORChain_Router-001,DUPE-THORChain_Router-007",,,,,
Unsatisfactory,validation-136,_transferOutAndCallV5 passes wrong argument to aggregator,"excess eth, transferOutPayload.amount and msg.value",,If and else clauses are distinctly separated,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L295-L404,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L295-L404,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L295-L404,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252",,,,,,,
Unsatisfactory,validation-145,THORChain_Router Contract Balance can be Emptied Due to Error in TransferOut Implementation,"excess eth, transferOutPayload.amount and msg.value",,Exploitable ETH transfer vulnerability in transfer functions,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L243,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L243",,"DUPE-THORChain_Router-005,DUPE-THORChain_Router-007,DUPE-THORChain_Router-008",DUPE-THORChain_Router-005,DUPE-THORChain_Router-007,DUPE-THORChain_Router-008,,
Unsatisfactory,validation-154,[H-01] Everyone can steal Router's stuck gas asset using `THORChain_Router::_transferOutV5`,"excess eth, transferOutPayload.amount and msg.value",,Exploitable ETH transfer vulnerability in transfer functions,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L185,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L185",,"DUPE-THORChain_Router-002,DUPE-THORChain_Router-008,DUPE-THORChain_Router-009",DUPE-THORChain_Router-009,,,,
Unsatisfactory,validation-165,Msg value not checked in _transferOutAndCallV5,"excess eth, transferOutPayload.amount and msg.value",,Low QA on user input error. The latter scenario would be exploiable instead.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,,,,,,
Unsatisfactory,validation-178,ETH can get Locked in the Thorchain  Router Contract,"excess eth, transferOutPayload.amount and msg.value",,Exploitable ETH transfer vulnerability in transfer functions,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L209-L229,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L209-L229",,"DUPE-THORChain_Router-002,DUPE-THORChain_Router-009,DUPE-THORChain_Router-016",DUPE-THORChain_Router-016,,,,
Unsatisfactory,validation-37,`_transferOutV5` implementation allows a discrepancy to happen which can cause loss of funds.,"excess eth, transferOutPayload.amount and msg.value",,Exploitable ETH transfer vulnerability in transfer functions,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L213",,"DUPE-THORChain_Router-002,DUPE-THORChain_Router-009,DUPE-THORChain_Router-017",DUPE-THORChain_Router-017,,,,
Unsatisfactory,validation-88,batchTransferOutV5() should return any excess ether to the caller,"excess eth, transferOutPayload.amount and msg.value",,Low QA on user input error,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L247-L253,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L247-L253",,,,,,,
Unsatisfactory,validation-148,[M-01] Missing assertion that no msg.value is not sent in transfer out functions in THORChain_Router,"excess eth, transferOutPayload.amount and msg.value",,Exploitable ETH transfer vulnerability in transfer functions,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L216,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L216",,"DUPE-THORChain_Router-002,DUPE-THORChain_Router-009,DUPE-THORChain_Router-016",DUPE-THORChain_Router-016,,,,
Unsatisfactory,validation-104,Inconsistent Vault Allowance Decrement in `transferOut`.,,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160,,,,,,,
Unsatisfactory,validation-105,Unchecked Allowance Depletion in `transferOut` Function Allows Unauthorized Asset Transfers.,,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L207,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L207,,,,,,,
Unsatisfactory,validation-106,Unchecked Allowance Adjustment in `transferAllowance` Allows Unauthorized Asset Transfers.,,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165-L177,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165-L177,,,,,,,
Unsatisfactory,validation-107,Misdirection of ERC-20 Tokens in `_deposit` Function Hinders Vault Allocation.,,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L150-L153,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L150-L153,,,,,,,
Unsatisfactory,validation-109,"Vault unable to send ETH/gas assets back to multisig wallets, causing users a loss of funds",call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L207,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L207",,,,,,,
Unsatisfactory,validation-11,`safeApprove` function not compatible with USDT,USDT approve(0),,Applicable only to the mainnet and inconsequential on Thorchain,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L485-L494,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,,,,,,
Unsatisfactory,validation-111,The function `THORChain_router::_routerDeposit` sets the expiry to `type(uint).max` by default which is similar to having no expiration.,max expiration,,Purportedly intended,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L476-L482,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L476-L482,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482",,,,,,,
Unsatisfactory,validation-114,Funds will be locked forever after churning of vaults.,max expiration,,Lacking concrete example alleging the flaw,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L481,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,,,,,,
Unsatisfactory,validation-115,`call()` should be used instead of `transfer()` on an `address payable`,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L403",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L403,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196",,,,,,,
Unsatisfactory,validation-116,USDC blacklisted users could DOS the `batchTransferOutV5` & `batchTransferOutAndCallV5` function.,,,Low QA frequently reported by bots and analyzers,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L247,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L247,,,,,,,
Unsatisfactory,validation-117,Sending batch withdrawal requests can possibly cause DoS.,,,Low QA frequently reported by bots and analyzers,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397,,,,,,,
Unsatisfactory,validation-118,`transferOut` & `transferOutAndCall` lacks an expiry parameter,,,Practically not needed,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,,,,,,,
Unsatisfactory,validation-12,should use `call` instead of `transfer`,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196",,,,,,,
Unsatisfactory,validation-120,call() should be used instead of transfer() and send(),call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L404",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L404,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160",,,,,,,
Unsatisfactory,validation-124,`safeApprove` in `_routerDeposit` could revert for non-standard token like USDT,USDT approve(0),,Applicable only to the mainnet and inconsequential on Thorchain,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L485,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,,,,,,
Unsatisfactory,validation-126,no check for  _dexAggSuccess,,,Inadequate elaboration,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L364,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L364,,,,,,,
Unsatisfactory,validation-127,DoS can occur in THORChain_Router.sol,,,Low QA frequently reported by bots and analyzers,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397-L403,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L397-L403,,,,,,,
Unsatisfactory,validation-128,Some tokens approvals and transactions will get reverted.,,,Informational,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474,,,,,,,
Unsatisfactory,validation-129,Unauthorized Vault Address in _deposit Function,,,Inadequate allowance would simply revert the call,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L157,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L157,,,,,,,
Unsatisfactory,validation-13,Incorrect Allowance Update Before ERC20 Transfer Confirmation in `transferOut` Function,"transfer fail, allowance cannot restore
 
 invalid, there is tranfer result check",,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L185,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L185,,,,,,,
Unsatisfactory,validation-130,Protocol in multiple instances uses `send` & `transfer` to transfer ETH which in many instances would fail,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L405",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L261-L282,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L261-L282,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L405",,,,,,,
Unsatisfactory,validation-132,Depositing via the router is done without sufficient deadline implementation,max expiration,more like a design choice,Purportedly intended,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L465-L483,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L465-L483,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482",,,,,,,
Unsatisfactory,validation-134,Depositing via any router through `THORChain_Router_routerDeposit()` could be easily broken for some supported tokens,USDT approve(0),,Applicable only to the mainnet and inconsequential on Thorchain,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L465-L483,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L465-L483,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494",,,,,,,
Unsatisfactory,validation-135,Protocol's way of transferring tokens is incorrectly implemented for some to-be integrated tokens,"wrong event
 failed swap should revert",,Would revert if bool is indeed false,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L437-L453,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L437-L453,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L387",,,,,,,
Unsatisfactory,validation-139,_routerdeposit wrongly sets expiration as type(uint).max,max expiration,,Purportedly intended,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L466-L483,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L466-L483,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482",,,,,,,
Unsatisfactory,validation-140,`safeApprove` function doesn't handle tokens that are missing the return value,"USDT safeApprove
 similar to approve(0)",,Low QA frequently reported by bots and analyzer,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L474,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L474,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494",,,,,,,
Unsatisfactory,validation-142,"In the _transferOutAndCallV5 function, failure to exchange may result in token loss.","other user will deduct their allowance
 malicious aggregator, steal failed swap fund",,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L375,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L347-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L324",,,,,,,
Unsatisfactory,validation-15,.send() may revert due to reciepient fallback gas consumption,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L152,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L152",,,,,,,
Unsatisfactory,validation-151,[M-04] Missing deadline check in transfer out functions,,,Practically not needed,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L269,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L269,,,,,,,
Unsatisfactory,validation-153,[M-05] Use of `.send()` may revert if the recipient's fallback consumes more than 2300 gas,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L406",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L152,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L406,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L152",,,,,,,
Unsatisfactory,validation-16,Allowance Check Missing in ERC20 Transfer Function,,,Inadequate allowance would simply revert the call,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,,,,,,,
Unsatisfactory,validation-160,if transferOutPayload[i] is contract cant accept ether batchTransferOutV5 will revert,call transfer,,Low QA frequently reported by bots and analyzers.,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397-L403,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397-L403,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L309-L311",,,,,,,
Unsatisfactory,validation-162,Use safeTransfer,,,Low QA frequently reported by bots and analyzer,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L201,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L201,,,,,,,
Unsatisfactory,validation-163,no check if amountOutMin is zero,user's own choice,,Will be taken care of by low level call on swapOut,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L261,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L261,,,,,,,
Unsatisfactory,validation-164,Safe approve is not working correctly,USDT approve(0),"The router would use all allowance, no enough proof of triggering the USDT case issue",Applicable only to the mainnet and inconsequential on Thorchain,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L485-L494,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L485-L494,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494",,,,,,,
Unsatisfactory,validation-166,Use call instead of transfer and send,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L407",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L327,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L407,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L323-L327",,,,,,,
Unsatisfactory,validation-167,safeTransferFrom is not safe due to lack of contract existence check,,,Low QA frequently reported by bots and analyzer,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L438-L453,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L438-L453,,,,,,,
Unsatisfactory,validation-168,Prevent stuck of ether,vault mistakenly send eth,,Low QA on user input mistake,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L185-L207,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L185-L207,,,,,,,
Unsatisfactory,validation-17,Ensuring Proper Allowance Verification in `transferAllowance` Function,,,Inadequate allowance would simply revert the call,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165,,,,,,,
Unsatisfactory,validation-172,_routerDeposit will fail for USDT,"USDT approve(0)
 rotate back and forward",,Applicable only to the mainnet and inconsequential on Thorchain,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L474,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L474,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494",,,,,,,
Unsatisfactory,validation-173,"No check for  ""chainid""",,,Low QA due to operational and detection controls,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L139,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L139,,,,,,,
Unsatisfactory,validation-174,calculation of gasPriceWei  can get  precision loss.,,,Low QA devoid of concrete example,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L256,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L256,,,,,,,
Unsatisfactory,validation-175,Insufficient Event Validation in `smartcontract_log_parser::unpackVaultLog`,"array length check, but the event is generated from here","the log parser is tuned with the router contract, no proof of triggering the described issue",Low QA due to runtime error from incorrect input,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L90-L109,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L90-L109,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L90-L109,,,,,,,
Unsatisfactory,validation-176,"In `transferOutAndCall` function, ether can be locked forever if the recipient is a contract.",call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280-L280,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L280-L280",,,,,,,
Unsatisfactory,validation-180,Use of payable.send() prevent honest contracts from transfer out ETH,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L408",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209-L215,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L408,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209-L215",,,,,,,
Unsatisfactory,validation-183,`call()` should be used instead of `transfer()`/`send()` on address payable,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L409",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L409,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196",,,,,,,
Unsatisfactory,validation-186,"Anyone can drain the Router contract, due to missing access control in the `_transferOutV5`",router does not hold eth,,Exploitable ETH transfer vulnerability in transfer functions,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L240-L244,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L240-L244,,,,,,,
Unsatisfactory,validation-188,Reentrancy Vulnerability in transferFrom Function in EvilToken.sol,,,Out of scope contract,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/EvilToken.sol?plain=1#L107-#L118,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/EvilToken.sol?plain=1#L107-#L118,,,,,,,
Unsatisfactory,validation-189,"only ETH allowed in ""transferOutAndCall""",,,Non-ETH may be via transferOutAndCallV5,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L261,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L261,,,,,,,
Unsatisfactory,validation-19,"Bad writing to send ETH correctly, leading to revert if the function fails.",call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L194-L197,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L194-L197,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L397",,,,,,,
Unsatisfactory,validation-190,"use ""safetransfer"" instead of ""Transfer""",,,Low QA frequently reported by bots and analyzer,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,,,,,,,
Unsatisfactory,validation-193,Front Running Vulnerability in EvilERC20Token Contract,,,Out of scope contract,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/EvilToken.sol?plain=1#L107-#L119,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/EvilToken.sol?plain=1#L107-#L119,,,,,,,
Unsatisfactory,validation-194,Use of the send() Function May Cause DOS,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L398",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L143-L160,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L398,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L143-L160",,,,,,,
Unsatisfactory,validation-195,Expiration timestamp is set to `type(uint).max` leading to transaction unable to fail after a user defined timestamp.,max expiration,,Purportedly intended,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482",,,,,,,
Unsatisfactory,validation-2,The `.send()` and `.transfer()` function may revert if the recipient's fallback function uses more than 2300 gas.,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L278,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L278",,,,,,,
Unsatisfactory,validation-20,Dangerous usage of block.timestamp can be manipulated by miners.,,,Infeasible with POS,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L138,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L138,,,,,,,
Unsatisfactory,validation-200,Usage of send() for ETH Transfer,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L410",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L152,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L410,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L152",,,,,,,
Unsatisfactory,validation-201,Rebasing Tokens Cause Incorrect Balance Calculations and Unexpected Behavior in safeTransferFrom Function,,No proof of specific case,Identifies and suggests supposed fix for FOT like or rebasing tokens,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L167,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L167,,,,,,,
Unsatisfactory,validation-202,Non-Standard Return Values of USDT’s transfer and approve Functions Cause Incorrect Handling in safeTransferFrom Function,,,Low QA frequently reported by bots and analyzer,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L167,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L167,,,,,,,
Unsatisfactory,validation-203,Non-Standard USDT approve Implementation May Cause Failed Transactions in THORChain_Router Contract,USDT approve(0),,Applicable only to the mainnet and inconsequential on Thorchain,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L181,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L181,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494",,,,,,,
Unsatisfactory,validation-204,Swaping tokens inside the `_transferOutAndCallV5` function might lead to losing them,other user will deduct their allowance,,Intended design (it's entirely the aggregator contract's responsibility to manage the funds),,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L341-L388,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L341-L388,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L341-L388,,,,,,,
Unsatisfactory,validation-205,Infinite Allowance in THORChain_Router Contract Exposes Users to Unauthorized Token Draining,,,Purportedly intended,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L181,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L181,,,,,,,
Unsatisfactory,validation-207,block.timestamp Manipulation in THORChain_Router's depositWithExpiry Function Allows Miners to Exploit Expiry Checks,,,Infeasible in POS,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L65,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L65,,,,,,,
Unsatisfactory,validation-208,"If `msg.sender` is a contract or multisig, the `safeAmount` may result into loss of the funds. ",call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L411",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L411,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196",,,,,,,
Unsatisfactory,validation-209,Short User-Defined Expiry Settings in depositWithExpiry Function Can Lead to Reverts Due to lack of Minimum Default Expiry,,,Infeasible in POS,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L65,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L65,,,,,,,
Unsatisfactory,validation-210,Network Delays Can Cause Transactions to Revert in depositWithExpiry Function Due to Close Expiration Time,,,Intended design,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L65,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L65,,,,,,,
Unsatisfactory,validation-211,Use `call` instead of `transfer` or `send`,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L412",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L152,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L412,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L152",,,,,,,
Unsatisfactory,validation-212,Usage of transfer() for ETH Transfer,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L413",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L413",,,,,,,
Unsatisfactory,validation-216,Unreliable ETH Transfer Mechanism in `returnVaultAssets` Function Due to `.send` Usage,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L414",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L408-L426,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L414,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L408-L426",,,,,,,
Unsatisfactory,validation-217,wrong accountations due to lack of proper updates to the `_vaultAllowance` mapping,"transfer fail, allowance cannot restore
 
 invalid, there is tranfer result check",,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L216,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L216,,,,,,,
Unsatisfactory,validation-22,Insufficient validation allows the contract to be drained,router does not hold eth,,Exploitable ETH transfer vulnerability in transfer functions,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209-L238,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209-L238,,,,,,,
Unsatisfactory,validation-220,Front-Running Vulnerability in EvilERC20Token Contract,,,Out of scope contract,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol?plain=1#L209-#L226,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol?plain=1#L209-#L226,,,,,,,
Unsatisfactory,validation-221,Missing onlyVault Check in transferAllowance Function,"anyone can transferAllowance
 only affect msg.sender",,Inadequate allowance would simply revert the call,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L165,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L165,,,,,,,
Unsatisfactory,validation-222,Lack of input validation in THORChain_Router:depositWithExpiry() can lead to DoS,0 amt event spam,,Low QA on minimal amount required,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131-L160,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131-L160,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131-L160",,,,,,,
Unsatisfactory,validation-223,`_vaultAllowances` could be tricked.,"anyone can transferAllowance
 only affect msg.sender",,It's msg.sender linked,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L209,,,,,,,
Unsatisfactory,validation-225,Inappropriate Use of `strings.EqualFold` for Hash Comparison,,,Inappropriate hash comparison; switch to bytes.Equal for accuracy.,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L452-L494,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L452-L494,,,,,,,
Unsatisfactory,validation-229,THORChain_Router:transferOutV5( ) Does not validate ETH amount given which will lead to protocol insolvancy,router does not hold eth,,Exploitable ETH transfer vulnerability in transfer functions,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L240-L244,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L240-L244,,,,,,,
Unsatisfactory,validation-237,Malicious user can flood the monitoring queue,0 amt event spam,,Low QA on minimal amount required,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131-L160,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131-L160,,,,,,,
Unsatisfactory,validation-238,Hardcoding the expiration date  in _routerDeposit( ) to type(uint).max can lead to halting fund transfer to the new router,max expiration,,Purportedly intended,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483,,,,,,,
Unsatisfactory,validation-24,"Do not return the erc20 token if swapOutV5() has failed, which results in the loss of this token.",failed swap should revert,,Inadequate elaboration,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,,,,,,,
Unsatisfactory,validation-240,Privileged Operation Vulnerability in privilegedOperation,,,It's msg.sender linked,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol?plain=1#L185-#L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol?plain=1#L185-#L389,,,,,,,
Unsatisfactory,validation-242,Zero value transfers  are not ignored in log-parser.go when they should be ignored since Zero value transfers and approvals should revert according to the README,,,Low QA frequently reported by bots and analyzers.,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L189-L192,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L189-L192,,,,,,,
Unsatisfactory,validation-243,Incorrect Allowance Handling on ERC20 Transfers,,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L344,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L342-L344,,,,,,,
Unsatisfactory,validation-244,Missing Event Emission in `transferAllowance` Function When Using External Router,,,Low QA frequently reported by bots and analyzers.,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165,,,,,,,
Unsatisfactory,validation-245,Incorrect access control on `THORChain_Router::transferOutAndCall` and doesn't work as intended and described in the Readme,"V4 func, miss allowance check or access control",,It's msg.sender linked,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L261-L293,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L261-L293,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L261-L293,,,,,,,
Unsatisfactory,validation-247,eth cannot be transferred across vaults or routers with `transferAllowance` function,,,Incorrect perception,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165-L178,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165-L178,,,,,,,
Unsatisfactory,validation-248,"The code assumes the genesis state is properly formatted. An attacker could provide malformed genesis state data, potentially leading to crashes or unexpected behavior.",,,Insufficient proof,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/app/app.go#L322,https://github.com/code-423n4/2024-06-thorchain/blob/main/app/app.go#L322,,,,,,,
Unsatisfactory,validation-249,Centralization Risk Leading to Permanent Loss of Funds Due to Unvalidated transferAllowance Calls by Malicious Vault Admins,max expiration,,It's msg.sender linked,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482",,,,,,,
Unsatisfactory,validation-25,Incorrect safeTransferFrom implementation,"USDT safeApprove
 similar to approve(0)",,Low QA frequently reported by bots and analyzer,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L451,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L451,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494",,,,,,,
Unsatisfactory,validation-251,Unauthorized transfer of assets via insufficient validation in `transferOutAndCallV5` allows an attacker to deplete router balances,,The vault is reponsible for filling correct target,It's msg.sender linked,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304,,,,,,,
Unsatisfactory,validation-252,Failure to Revert on Critical Failures in THORChain_Router Contract,"failed swap should revert
 low quality report",,Revert measures well in place,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol?plain=1#L185-#L389,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol?plain=1#L185-#L389,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L362-L375",,,,,,,
Unsatisfactory,validation-29,withdraw ERC20 tokens,,,Low QA on users' mistakes,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,,,,,,,
Unsatisfactory,validation-30,Use of `.send()` could revert if the recipient's fallback function consumes more than 2300 Gas,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L398",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L194,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L398,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L194",,,,,,,
Unsatisfactory,validation-31,Inconsistent Allowance Updates in transferOut Function,"transfer fail, allowance cannot restore
 
 invalid, there is tranfer result check",,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185,,,,,,,
Unsatisfactory,validation-32,Lack of ERC-20 Approvals Prevents THORChain_Router Contract From Functioning as Intended,should reduce router allowance,,Approval is done outside the contract and before the call,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L156,,,,,,,
Unsatisfactory,validation-34,Arbitrary users can manipulate vault allowances and transfer assets,,,Insufficient proof alleging the flaw,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165-L178,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165-L178,,,,,,,
Unsatisfactory,validation-38,Incorrect safeApprove implementation,"USDT safeApprove
 similar to approve(0)",,Low QA frequently reported by bots and analyzer,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L485-L495,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L485-L495,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494",,,,,,,
Unsatisfactory,validation-41,Vaults can transfer their allowance to stale vaults,,,Lacking concrete example alleging the flaw,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L481,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L481,,,,,,,
Unsatisfactory,validation-42,depositWithExpiry function callable by anyone in the THORChain_Router contract,,,It's msg.sender linked,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131-L140,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131-L140,,,,,,,
Unsatisfactory,validation-43,The router will not work with USDT and KNC tokens,"USDT approve(0)
 only this report points out the reason is rotating back and forward
 
 seems invalid, not sure why the vaults are rotating",allowance consumed in the next lines that call depositWithExpiry(),Applicable only to the mainnet and inconsequential on Thorchain,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L474-L494,,,,,,,
Unsatisfactory,validation-53,Deadline parameter set to `type(uint256).max` in `_routerDeposit()` allows for unfavorable terms,max expiration,,Purportedly intended,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L466-L483,,,,,,,
Unsatisfactory,validation-54,"No ability to send funds back if transferOutPayload.to fails to receive funds, and  payable(address(msg.sender)) also fails to receive it",call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L399",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L399,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L196",,,,,,,
Unsatisfactory,validation-55,vault.send will return success if sending ETH to vault address that is non-existed contract,call transfer,,Low QA frequently reported by bots and analyzers.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L152,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L152",,,,,,,
Unsatisfactory,validation-56,"Attacker can drain contract sending incorrect amounts in payload, on ETH transfer in transferOutV5 and batchTransferOutV5",router does not hold eth,,Exploitable ETH transfer vulnerability in transfer functions,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L247-L253,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L247-L253,,,,,,,
Unsatisfactory,validation-59,The router contract can be drained,router does not hold eth,,Exploitable ETH transfer vulnerability in transfer functions,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L211,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L211,,,,,,,
Unsatisfactory,validation-61,THORChain_Router Fails to Remove ERC20 Token Allowances During Transfers,msg.sender is the router,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L176,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L176,,,,,,,
Unsatisfactory,validation-63,Use of `.send()/payable.transfer()` May Revert if The Recipient's Fallback Function Consumes More Than 2300 Gas,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L400",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L152-L152,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L400,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L152-L152",,,,,,,
Unsatisfactory,validation-65,"Rely on the token address in the accounting, this can introduce vulnerabilities and complications in the accounting and handling of these tokens, as the same logical token could have different addresses. This situation can lead to inconsistencies, incorrect balances, and potential exploits if the system incorrectly assumes that each address represents a distinct token.",multi address token,,Low QA on double entry tokens,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L54,,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L54,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L54,,,,,,,
Unsatisfactory,validation-66,Migrating vault is not putting a proper deadline,max expiration,,Purportedly intended,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L481,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L476-L482,,,,,,,
Unsatisfactory,validation-67,Potential resource leaks or deadlocks,,,Improper semaphore handling,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L351-L372,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L351-L372,,,,,,,
Unsatisfactory,validation-68,A potential vulnerability where dereferencing a nil pointer can lead to a runtime panic,"event existence check, but the event is generated from here",,Low QA due to runtime panic from nil pointer (incorrect input),,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L90-L109,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L90-L109,,,,,,,
Unsatisfactory,validation-70,"Some functions doesn't have a check for msg.value being 0 in case of ERC20 transfer, which could lead to loss of funds",,,Low QA on user input mistake,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L198-L205,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L198-L205,,,,,,,
Unsatisfactory,validation-71,The smartcontract_log_parser.go client is not checking is the `depositWithExpired` function is used with a correct vault,"miss validation `to` value
 seems invalid, line 193 is the check",,Valid vault verification minimizes risk albeit potential exploit unlikely significant.,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L182-L195,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L182,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L182-L195,,,,,,,
Unsatisfactory,validation-72,Malicius user can spam the chain sending depositing just 1 wei,dust spam to DoS Bifrost,,Low QA on spamming,"https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L189,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L295",,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L189,"https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L189,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L295",,,,,,,
Unsatisfactory,validation-73,Using memo param as string can cause DoS,,,OOS for possibly future changes,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L412,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L412,,,,,,,
Unsatisfactory,validation-75,Sending ether with `send` ot `transfer` may result in transactions running out of gas for contract addresses,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L401",,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L211,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L401,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L211",,,,,,,
Unsatisfactory,validation-78,Overpayment of native ETH is not refunded in transferOutV5 function,"excess eth, transferOutPayload.amount and msg.value",,Low QA on user input error,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L243,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L250-L252,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L304-L328,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L243",,,,,,,
Unsatisfactory,validation-79,`Removed` field from event log is ignored which can lead to false event being processed,reorg,reorg process here https://github.com/code-423n4/2024-06-thorchain/blob/e3fd3c75ff994dce50d6eb66eb290d467bd494f5/bifrost/pkg/chainclients/ethereum/ethereum_block_scanner.go#L323,Ignoring Removed field can process invalid events,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L166,,,,,,,
Unsatisfactory,validation-84,leading to a denial of service (DoS) situation,0 amt event spam,,Low QA on user input error,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131-L160,,https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L1,"https://github.com/code-423n4/2024-06-thorchain/blob/main/bifrost/pkg/chainclients/shared/evm/smartcontract_log_parser.go#L1,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131-L160",,,,,,,
Unsatisfactory,validation-86,Thorchain does not allow users to send ETH to the contract recipients.,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L402",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L194,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L402,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L194",,,,,,,
Unsatisfactory,validation-89,Anyone can steal ether stuck on router contract,router does not hold eth,,Exploitable ETH transfer vulnerability in transfer functions,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L198,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L198,,,,,,,
Unsatisfactory,validation-92,Risk of Accepting Expired Transactions in THORChain_Router Deposit Function,,,Illogical assumptions,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131-L140,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L131-L140,,,,,,,
Unsatisfactory,validation-93,Risk of Unauthorized ERC20 Token Transfers Due to Insufficient Allowance Check in THORChain_Router Transfer Function,,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L199-L205,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L199-L205,,,,,,,
Unsatisfactory,validation-94,Vulnerability in THORChain_Router Allows Unauthorized Asset Allowance Transfers,,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165-L178,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L165-L178,,,,,,,
Unsatisfactory,validation-95,Risk of Failed ETH Transfers in _deposit Function Due to Fixed Gas Stipend,call transfer,,Low QA frequently reported by bots and analyzers. It happens on zkSync though.,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396",,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160,"https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L196,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L213,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L280,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L396,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160",,,,,,,
Unsatisfactory,validation-96,Risk of Token Misallocation in _deposit Function Due to Immediate Vault Allowance Update,,,That's a good CEI practice where _vaultAllowance is meant simply for internal accounting,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143-L160,,,,,,,
Unsatisfactory,validation-97,Zero-Value Deposits Lead to Inflated Event Logs and Unnecessary Blockchain Transactions,0 amt event spam,,Low QA on traffic clog,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131-L160,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143,"https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L143,https://github.com/code-423n4/2024-06-thorchain/blob/main/ethereum/contracts/THORChain_Router.sol#L131-L160",,,,,,,
Unsatisfactory,validation-99,User ETH's can be accidentally locked up in the router contract .,user mistakenly sent eth,,Low QA on user input error,,,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L207,https://github.com/code-423n4/2024-06-thorchain/blob/main/chain/ethereum/contracts/THORChain_Router.sol#L185-L207,,,,,,,